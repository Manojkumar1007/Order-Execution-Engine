<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eterna Order Execution Engine</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <h1>üí´ Eterna Engine</h1>
            <div class="status-badges">
                <span id="server-status" class="badge">Checking Server...</span>
                <span id="ws-status" class="badge">WS Disconnected</span>
            </div>
        </header>

        <main>
            <!-- Top Section: Stats & Metrics -->
            <section class="grid-section">
                <div class="card metrics-card">
                    <h2>Queue Metrics</h2>
                    <div class="metric-grid" id="metrics-container">
                        <div class="metric-item">
                            <span class="label">Testing...</span>
                            <span class="value">-</span>
                        </div>
                    </div>
                    <button onclick="fetchMetrics()" class="btn-secondary">Refresh</button>
                </div>

                <div class="card health-card">
                    <h2>System Health</h2>
                    <pre id="health-output">Loading...</pre>
                    <button onclick="checkHealth()" class="btn-secondary">Check Now</button>
                </div>
            </section>

            <!-- Order Execution Form -->
            <section class="card execution-card">
                <h2>üöÄ Execute Order</h2>
                <form id="order-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Token In</label>
                            <input type="text" id="tokenIn" value="SOL" placeholder="e.g. SOL" required>
                        </div>
                        <div class="form-group">
                            <label>Token Out</label>
                            <input type="text" id="tokenOut" value="USDC" placeholder="e.g. USDC" required>
                        </div>
                        <div class="form-group">
                            <label>Amount</label>
                            <input type="number" id="amount" value="1.0" step="0.1" required>
                        </div>
                        <div class="form-group">
                            <label>Slippage (%)</label>
                            <input type="number" id="slippage" value="0.5" step="0.1" min="0" max="100" required>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button type="submit" class="btn-primary" style="flex: 1;">Execute Order</button>
                        <button type="button" id="btn-batch" class="btn-secondary"
                            style="flex: 1; border-color: var(--primary); color: var(--primary);">Execute 5
                            Orders</button>
                    </div>
                </form>
            </section>

            <!-- Real-time Logs -->
            <section class="card logs-card">
                <div class="card-header">
                    <h2>üìú Live Execution Logs</h2>
                    <button onclick="clearLogs()" class="btn-text">Clear</button>
                </div>
                <div id="logs-container" class="logs-container">
                    <div class="log-entry system">Ready to execute orders...</div>
                </div>
            </section>

            <!-- Track Specific Order -->
            <section class="card tracking-card">
                <h2>üîç Track Specific Order</h2>
                <div class="form-grid" style="grid-template-columns: 3fr 1fr;">
                    <div class="form-group">
                        <label>Order ID</label>
                        <input type="text" id="track-order-id" placeholder="Paste Order UUID here..." required>
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button type="button" id="btn-track" class="btn-primary">Connect</button>
                    </div>
                </div>
                <div id="json-output-container"
                    style="display: none; margin-top: 1rem; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 6px;">
                    <h3 style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem;">Live Protocol
                        Message:</h3>
                    <pre id="json-viewer"
                        style="color: #cbd5e1; font-size: 0.85rem; max-height: 200px; overflow-y: auto;">Waiting for data...</pre>
                </div>
            </section>

            <!-- Recent Orders -->
            <section class="card recent-orders-card">
                <div class="card-header">
                    <h2>Recent Orders (Max 10)</h2>
                    <button onclick="fetchRecentOrders()" class="btn-secondary">Refresh</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Pair</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>DEX</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="orders-table-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
</body>

</html>